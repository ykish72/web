<!DOCTYPE html>
<!--
Created using JS Bin
http://jsbin.com

Copyright (c) 2017 by anonymous (http://jsbin.com/povubisigu/1/edit)

Released under the MIT license: http://jsbin.mit-license.org
-->
<meta name="robots" content="noindex">
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="혜린이와 아빠의 javascript 공부하기. 1단계로 간단히 카드 짝 맞으면 사라지고, 틀리면 다시 덮힘. 다음 2단게로 점수 기능등 추가 예정.">
  <title>혜리니네 카드짝 맞추기</title>
  <script src="https://code.jquery.com/jquery.min.js"></script>
<link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet" type="text/css" />
<script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js"></script>
<script src="https://cdn.rawgit.com/nnattawat/flip/master/dist/jquery.flip.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.4.4/underscore-min.js"></script>
<script type="text/javascript" src="toast.min.js"></script>
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script> -->
<style id="jsbin-css">
  @media (max-width: 767px) { /* bootstrap 기본 css 지정 무력화. */
    body {
        padding-left: 0;
        padding-right: 0;
    }
  }

.header {
  background: blue;
  color: white;
  width: 100%;
  height:3em;
  margin: 0;
  padding: 0;
}
.content {
  position:absolute;
  top: 3em;
  bottom: 0;
  width: 100%;
}
.card {
  width:5em;height:5em;
  float: left;
  margin:0.5em;
}
.front, back {
  width:100%; height:100%;
}
#nTurn {
  display: inline-block;
  width: 3em;
  height: 1.5em;
  text-align: right;
  border-radius: 4px;
  padding:2px;
  border: 1px solid gray;
}
</style>
</head>
<body>
  <div class='header'>
    <div style="padding:8px;">카드짝 맞추기</div>
    <div style="position:absolute;right:15px;top: 5px;">
      횟수: <span id="nTurn"> 0</span>

    </div>
  <div class='content'>content</div>
<script id="jsbin-javascript">

  var nTurns = 0;

var options = {
	settings: {
		duration: 1500
	}
};
     function showToast(str) {
        iqwerty.toast.Toast(str, options);
    }  

(function($){

    $.fn.shuffle = function() {
        return this.each(function(){
            var items = $(this).children().clone(true);
            return (items.length) ? $(this).html($.shuffle(items)) : this;
        });
    }
    
    $.shuffle = function(arr) {
        for(var j, x, i = arr.length; i; j = parseInt(Math.random() * i), x = arr[--i], arr[i] = arr[j], arr[j] = x);
        return arr;
    }
    
})(jQuery);


var cardType = 'color'; // img, color
var cardTotal = 16; //32;
var colorArray = ['Aqua', 'Aquamarine', 'Beige', 'Black', 'Blue', 'BlueViolet', 'Brown', 'BurlyWood',
                'Yellow', 'Chartreuse', 'Coral', 'CornflowerBlue', 'Crimson', 'Cyan' ,'Red', 'Green'  ]


function initCards(pid, ctype, cardTotal_) {
  var html="";
  var cardCnt = cardTotal_ / 2;
  var newCArry_ = colorArray.slice(0, cardCnt);
  var newCArry = $.shuffle( newCArry_.concat(colorArray.slice(0, cardCnt)) );
  
  for (var i=0; i< newCArry.length; i++) {
      var c = newCArry[i];
      // _.template(template,{items:items});
      var txt = $("#t_card").html();
      var ret = _.template(txt,{c:c, i:i})
      html += ret; // "<div class='card' style='background-color:"+ c + "' data-name='"+ c + "'></div>";
  }
  $(pid).html(html);
}


_.templateSettings = {
    interpolate: /\<\@\=(.+?)\@\>/gim,
    evaluate: /\<\@([\s\S]+?)\@\>/gim,
    escape: /\<\@\-(.+?)\@\>/gim
};


var choosedOne = undefined;
var choosedIdx = undefined;
$(document).ready(function(){
  
  initCards('.content', cardType, cardTotal);
  $(".card").each( function(i, el){
    $(el).flip({trigger:'click'}).flip(true);
  })
  $(".front, .back").click(function() {
  // $(".card").click(function() {
    if ($(this).hasClass('back')) {
      var name = $(this).parent().attr('data-name');
      if (!choosedOne) {
        choosedOne = name;
        choosedIdx = $(this).parent().attr('data-index');
        return;
      }
      nTurns++;
      $("#nTurn").html(nTurns);

      if (choosedOne != name) {
        var this_ = this;
        //틀리니까 원래대로 뒤집어요.
          showToast("You are wrong.");
        setTimeout(function() {
          $("div[data-index="+ choosedIdx+"]").flip(true);
          $(this_).parent().flip(true);
        }, 1500);
      } else {
        // 맞췄음. 두 개의 card를 사라지게 한다.
        showToast("You got it.");
        setTimeout(function() {
          $("div[data-name=" + name + "]").css('visibility', 'hidden'); // visible
        }, 1500)
      }

      choosedOne = undefined;
    } else { // front 뒤집어 진 것이면
    }
  })
});
</script>

<script type="text/html" id="t_card">
<div class="card" data-name="<@=c@>" data-index="<@=i@>"> 
  <div class="front" style="background-color:<@=c@>" > 
  </div> 
  <div class="back" style="background-color:gray">
  </div> 
</div>
</script>

</body>
</html>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-102285586-1', 'auto');
  ga('send', 'pageview');

</script>